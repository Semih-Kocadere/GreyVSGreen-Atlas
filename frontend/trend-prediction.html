<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<link rel="icon" type="image/png" href="../images/favicon.png"/>
<title>Trend Tahmini â€” Grey vs Green Atlas</title>

<!-- 
  ============================================================================
  GREY VS GREEN ATLAS - TREND PREDICTION PAGE
  ============================================================================
  
  Explanation:
    UNET + Conv3D temporal model for future period (t+1) predictions.
    Trend analysis of green areas, concrete, and water resources for Istanbul.
  
  Features:
    - Interactive map (Leaflet)
    - Timeline slider
    - Comparison mode (split-screen)
    - Prediction overlays
    - Statistics panel
  
  Model:
    - UNET: 4-class segmentation (background, green, gray, water)
    - Conv3D: Temporal prediction (8 quarters â†’ t+1)
  
  ============================================================================
-->

<link rel="stylesheet" href="/css/common.css">
<link rel="stylesheet" href="/css/trend-prediction.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

</head>
<body style="background: transparent;">
<!-- Top Bar -->
<header class="topbar">
  <div class="topbar-left">
    <button class="sidebar-toggle" id="sidebar-toggle" title="Sidebar AÃ§/Kapat">â˜°</button>
    <div class="topbar-brand" style="cursor:default">ğŸŒ Grey vs Green Atlas</div>
    <div class="topbar-search">
      <input type="text" placeholder="Åehir veya analiz ara..."/>
    </div>
  </div>
  <div class="topbar-right">
    <button class="topbar-btn">ğŸ”” <span>3</span></button>
    <div class="topbar-user">
      <span>ğŸ‘¤</span>
      <span id="who">YÃ¼kleniyor...</span>
    </div>
    <button class="topbar-logout" id="logout">
      <span>ğŸšª</span>
      <span>Ã‡Ä±kÄ±ÅŸ</span>
    </button>
  </div>
</header>

<div class="layout">
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-resizer" id="sidebar-resizer"></div>
    <!-- Main Menu -->
    <div class="sidebar-section">
      <div class="sidebar-title">Ana MenÃ¼</div>
      <nav class="nav">
        <a href="/dashboard.html" id="nav-dashboard">
          <span>ğŸ“Š</span>
          <span>Dashboard</span>
        </a>
        <a href="/map.html" id="nav-map">
          <span>ğŸ—ºï¸</span>
          <span>Harita</span>
        </a>
        <a href="/istanbul-detail.html" id="nav-istanbul">
          <span>ğŸ”¬</span>
          <span>Ä°stanbul Detay</span>
        </a>
        <a href="/trend-prediction.html" id="nav-trend" class="active">
          <span>ğŸ“ˆ</span>
          <span>Trend Tahmini</span>
        </a>
      </nav>
    </div>
    
    <!-- Data Management -->
    <div class="sidebar-section">
      <div class="sidebar-title">Veri YÃ¶netimi</div>
      <nav class="nav">
        <a href="/data-sources.html" id="nav-data-sources">
          <span>ğŸ›°ï¸</span>
          <span>Veri KaynaklarÄ±</span>
        </a>
        <a href="/data-upload.html" id="nav-data-upload">
          <span>ğŸ“¤</span>
          <span>Veri Setleri</span>
        </a>
        <a href="/reports.html" id="nav-reports">
          <span>ğŸ§¾</span>
          <span>Raporlar</span>
        </a>
      </nav>
    </div>
    
    <!-- System -->
    <div class="sidebar-section">
      <div class="sidebar-title">Sistem</div>
      <nav class="nav">
        <a href="/settings.html" id="nav-settings">
          <span>âš™ï¸</span>
          <span>Ayarlar</span>
        </a>
      </nav>
    </div>
    
    <!-- Model Information -->
    <div class="sidebar-footer">
      <div class="sidebar-title">Model Bilgisi</div>
      <div class="sidebar-stats">
        <div class="sidebar-stat">
          <span class="sidebar-stat-label">Model</span>
          <span class="sidebar-stat-value">UNET+Conv3D</span>
        </div>
        <div class="sidebar-stat">
          <span class="sidebar-stat-label">Sequence</span>
          <span class="sidebar-stat-value">8 Quarters</span>
        </div>
        <div class="sidebar-stat">
          <span class="sidebar-stat-label">DoÄŸruluk</span>
          <span class="sidebar-stat-value">~94%</span>
        </div>
      </div>
    </div>
  </aside>
  
  <main class="main">
    <div class="header dashboard-header">
      <h1 class="dashboard-title">
        <span class="dashboard-icon">ğŸŒ±</span>
        <span>Ä°stanbul Trend Tahmini</span>
      </h1>
      <div class="dashboard-desc">
        GeleceÄŸin Ä°stanbul'u iÃ§in <span class="highlight-green">yeÅŸil alan</span>, <span class="highlight-grey">beton</span> ve <span class="highlight-water">su kaynaklarÄ±</span> tahmini. Åehrin ekolojik dÃ¶nÃ¼ÅŸÃ¼mÃ¼nÃ¼ keÅŸfedin.
      </div>
    </div>


  <!-- Map Container -->
  <div class="map-container" style="position:relative;">
      <div class="map-outer">
        <!-- Top Left: Modern Viewing Mode Panel -->
        <div class="floating-mode-panel left-panel">
          <div class="modern-panel">
            <div class="modern-panel-title">GÃ¶rÃ¼ntÃ¼leme Modu</div>
            <div class="modern-mode-buttons" role="group" aria-label="GÃ¶rÃ¼ntÃ¼leme Modu">
              <button class="modern-mode-btn active" id="mode-prediction" data-mode="prediction" aria-pressed="true">Tahmin</button>
              <button class="modern-mode-btn" id="mode-comparison" data-mode="comparison" aria-pressed="false">KarÅŸÄ±laÅŸtÄ±rma</button>
            </div>
          </div>
        </div>
        <!-- Top Right: Modern Overlay Opacity Panel -->
        <div class="floating-opacity-panel right-panel">
          <div class="modern-panel">
            <div class="modern-panel-title">Overlay ÅeffaflÄ±k</div>
            <div class="modern-slider-row">
              <input type="range" id="opacity-slider" min="0" max="100" value="70" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" class="modern-slider" />
              <span id="opacity-value" class="modern-slider-value">70%</span>
            </div>
          </div>
        </div>
        <!-- Top Center: Modern Horizon Panel -->
        <div class="floating-horizon-panel top-center-panel">
          <div class="modern-panel">
            <div class="modern-horizon-group">
              <label for="horizon-select" class="modern-horizon-label">Tahmini Horizon</label>
              <select id="horizon-select" class="modern-horizon-select">
                <option value="1">t+1 (1 Ã‡eyrek)</option>
                <option value="4">t+4 (1 YÄ±l)</option>
                <option value="8">t+8 (2 YÄ±l)</option>
              </select>
            </div>
          </div>
        </div>
        <div id="map" class="map" aria-label="Tahmin HaritasÄ±"></div>
        <canvas id="mask-canvas" width="256" height="256" class="mask-canvas"></canvas>
        <!-- Loading animation -->
        <div id="loading-overlay" class="loading-overlay">
          <div class="loading-spinner">â³</div>
          <div class="loading-text">Harita yÃ¼kleniyor...</div>
        </div>
      </div>
      <!-- Comparison Mode Second Map -->
      <div id="map-compare" class="map map-hidden" aria-label="KarÅŸÄ±laÅŸtÄ±rma HaritasÄ±"></div>
      <!-- Legend -->
      <div class="map-legend" aria-label="SÄ±nÄ±f Renkleri">
        <div class="legend-title">SÄ±nÄ±flandÄ±rma</div>
        <div class="legend-item">
          <span class="legend-color" style="background: #10b981;"></span>
          <span>YeÅŸil Alan</span>
        </div>
        <div class="legend-item">
          <span class="legend-color" style="background: #6b7280;"></span>
          <span>Beton</span>
        </div>
        <div class="legend-item">
          <span class="legend-color" style="background: #3b82f6;"></span>
          <span>Su KaynaklarÄ±</span>
        </div>
        <div class="legend-item">
          <span class="legend-color" style="background: #000000;"></span>
          <span>Arka Plan</span>
        </div>
      </div>
    </div>

    <!-- Timeline Slider + Horizon Dropdown -->
    <div class="timeline-container">
      <!-- Trend Chart -->
      <!-- Folium Map and Download Button Area -->
      <div id="folium-map-section" class="folium-map-section">
        <div class="folium-section-title" style="font-size:1.35rem;font-weight:600;color:#10b981;margin-bottom:12px;letter-spacing:0.01em;">Folium Mozaik HaritasÄ±</div>
        <div id="folium-map-container" class="folium-map-container"><!-- Burada folium haritasÄ± gÃ¶sterilecek -->
          <span style="color:#6b7280;">Tahmin haritasÄ± burada gÃ¶rÃ¼necek</span>
        </div>
      </div>

      <!-- Stats Cards -->
      <div class="stats-container">
        <div class="stat-card-trend">
          <div class="stat-icon">ğŸŒ³</div>
          <div class="stat-content">
            <div class="stat-label">YeÅŸil Alan</div>
            <div class="stat-value">
              <span id="stat-green-current">32.5%</span>
              <span class="stat-arrow">â†’</span>
              <span id="stat-green-predicted" class="predicted">31.8%</span>
            </div>
            <div class="stat-change negative" id="stat-green-change">-0.7%</div>
          </div>
        </div>
        
        <div class="stat-card-trend">
          <div class="stat-icon">ğŸ¢</div>
          <div class="stat-content">
            <div class="stat-label">Beton Alan</div>
            <div class="stat-value">
              <span id="stat-gray-current">60.2%</span>
              <span class="stat-arrow">â†’</span>
              <span id="stat-gray-predicted" class="predicted">61.1%</span>
            </div>
            <div class="stat-change positive" id="stat-gray-change">+0.9%</div>
          </div>
        </div>
        
        <div class="stat-card-trend">
          <div class="stat-icon">ğŸ’§</div>
          <div class="stat-content">
            <div class="stat-label">Su KaynaklarÄ±</div>
            <div class="stat-value">
              <span id="stat-water-current">7.3%</span>
              <span class="stat-arrow">â†’</span>
              <span id="stat-water-predicted" class="predicted">7.1%</span>
            </div>
            <div class="stat-change negative" id="stat-water-change">-0.2%</div>
          </div>
        </div>
      </div>

      <!-- Information Note -->
      <div class="info-box">
        <div class="info-icon">â„¹ï¸</div>
        <div class="info-content">
          <strong>Model HakkÄ±nda:</strong> Bu tahminler, 2018-2024 arasÄ± Sentinel-2 uydu gÃ¶rÃ¼ntÃ¼leri kullanÄ±larak
          eÄŸitilmiÅŸ UNET (segmentasyon) ve Conv3D (temporal prediction) derin Ã¶ÄŸrenme modelleriyle Ã¼retilmiÅŸtir.
          Model, son 8 Ã§eyrek dÃ¶nemi (2 yÄ±l) kullanarak bir sonraki Ã§eyrek tahmini yapmaktadÄ±r.
          Ortalama doÄŸruluk: <strong>~94%</strong> (Pixel Accuracy), <strong>~91%</strong> (mIoU).
        </div>
      </div>
    </main>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="./js/trend-prediction.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</body>
</html>
